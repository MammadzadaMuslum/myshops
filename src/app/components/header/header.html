<mat-toolbar
  class="sticky top-0 left-0 w-full z-50 !bg-white/80 backdrop-blur-xl border-b border-gray-200"
>
  <div class="w-full max-w-7xl mx-auto flex items-center justify-between px-4">
    <a routerLink="/" class="flex items-center gap-3 select-none group">
      <div
        class="w-10 h-10 rounded-2xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center text-white font-extrabold shadow-sm group-hover:scale-105 transition"
      >
        M
      </div>
      <div class="flex flex-col leading-tight">
        <span class="text-lg font-extrabold text-gray-900 tracking-tight">MyShops</span>
        <span class="text-xs text-gray-500 -mt-0.5">Modern Store Experience</span>
      </div>
    </a>

    <!-- DESKTOP NAV -->
    <nav class="hidden md:flex items-center gap-8 text-sm font-semibold text-gray-700">
      <a
        routerLink="/"
        routerLinkActive="text-blue-600"
        [routerLinkActiveOptions]="{ exact: true }"
        class="relative hover:text-blue-600 transition"
      >
        Home
        <span
          class="absolute left-0 -bottom-2 h-[2px] w-0 bg-blue-600 transition-all duration-300 group-hover:w-full"
        ></span>
      </a>
      <a
        routerLink="/shops"
        routerLinkActive="text-blue-600"
        class="hover:text-blue-600 transition"
        >Shops</a
      >
      <a
        routerLink="/admin"
        routerLinkActive="text-blue-600"
        class="hover:text-blue-600 transition"
        >Admin</a
      >
    </nav>

    <div class="hidden md:flex items-center gap-3">
      <ng-container *ngIf="!userService.user()">
        <a
          mat-button
          routerLink="/login"
          class="!rounded-xl !px-4 !py-2 !font-semibold !text-gray-700 hover:!bg-gray-100 transition"
        >
          Login
        </a>
        <a
          mat-flat-button
          color="primary"
          routerLink="/register"
          class="!rounded-xl !px-5 !py-2 !font-semibold !shadow-sm hover:!shadow-md transition"
        >
          Register
        </a>
      </ng-container>

        <ng-container *ngIf="userService.user()">
        <div class="relative group">
          <button
            class="flex items-center gap-2  px-3 py-2 hover:bg-gray-100 transition cursor-pointer"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-gray-700" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
            <span class="font-medium text-gray-800">{{ userService.user()?.name }}</span>
          </button>

  
          <div
            class="absolute right-0 mt-2 w-40 bg-white rounded-xl shadow-lg opacity-0 invisible group-hover:visible group-hover:opacity-100 transition-all duration-200"
          >
            <a
              routerLink="/profile"
              class="flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 transition rounded-lg"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
              Profile
            </a>
            <button
              (click)="logout()"
              class="flex items-center gap-2 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 transition rounded-lg cursor-pointer"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
              </svg>
              Logout
            </button>
          </div>
        </div>
      </ng-container>
    </div>

    <!-- MOBILE MENU -->
    <div class="md:hidden flex items-center">
      <button [matMenuTriggerFor]="menu" class="!rounded-xl">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-6 h-6"
          fill="currentColor"
          viewBox="0 0 24 24"
        >
          <path d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>

      <mat-menu #menu="matMenu" class="!rounded-2xl">
        <button mat-menu-item routerLink="/">Home</button>
        <button mat-menu-item routerLink="/shops">Shops</button>
        <button mat-menu-item routerLink="/admin">Admin</button>
        <mat-divider></mat-divider>

        <ng-container *ngIf="!userService.user()">
          <button mat-menu-item routerLink="/login">Login</button>
          <button mat-menu-item routerLink="/register">Register</button>
        </ng-container>

        <ng-container *ngIf="userService.user()">
          <button mat-menu-item routerLink="/profile">Profile</button>
          <button mat-menu-item (click)="logout()">Logout</button>
        </ng-container>
      </mat-menu>
    </div>
  </div>
</mat-toolbar>
